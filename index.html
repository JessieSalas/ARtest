<!DOCTYPE html>
<html>
<head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
        body { margin: 0; overflow: hidden; }
        #control-container { position: fixed; bottom: 10px; width: 100%; text-align: center; padding: 5px; background: rgba(255,255,255,0.6); }
        .control { margin: 5px; }
    </style>
</head>
<body>

<a-scene embedded arjs='sourceType: webcam;'>
    <a-assets>
        <img id="d3-image" crossorigin="anonymous">
    </a-assets>
    <a-marker preset="hiro">
        <a-plane position="0 0 0" rotation="-90 0 0" width="1" height="1" material="src: #d3-image;"></a-plane>
    </a-marker>
    <a-entity camera></a-entity>
</a-scene>

<div id="control-container">
    <!-- Control to change color -->
    <select id="colorSelector" class="control">
        <option value="green">Green</option>
        <option value="red">Red</option>
        <option value="blue">Blue</option>
    </select>

    <!-- Control for size -->
    <select id="sizeSelector" class="control">
        <option value="small">Small</option>
        <option value="medium">Medium</option>
        <option value="large">Large</option>
    </select>

    <!-- Control for number of circles -->
    <select id="numberSelector" class="control">
        <option value="1">One Circle</option>
        <option value="2">Two Circles</option>
        <option value="3">Three Circles</option>
    </select>
</div>

<iframe id="d3-iframe" style="display:none;" src="visualization.html"></iframe>

<script>
    var iframe = document.getElementById('d3-iframe');

    document.querySelectorAll('.control').forEach(function(control) {
        control.addEventListener('change', function() {
            var message = {
                type: 'updateVisualization',
                color: document.getElementById('colorSelector').value,
                size: document.getElementById('sizeSelector').value,
                number: document.getElementById('numberSelector').value
            };
            iframe.contentWindow.postMessage(message, '*');
        });
    });

    window.addEventListener('message', function(event) {
        if (event.data.type === 'render') {
            var img = document.getElementById('d3-image');
            img.src = event.data.dataUrl;
        }
    });
</script>

</body>
</html>
