<!DOCTYPE html>
<html>
<head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>
    <style>
        #hidden-container {
            position: absolute;
            width: 300px;
            height: 300px;
            overflow: hidden;
            visibility: hidden;
            pointer-events: none;
        }
    </style>
</head>
<body style="margin: 0; overflow: hidden;">

<div id="hidden-container">
    <iframe id="d3-iframe" src="visualization2.html" width="300" height="300"></iframe>
</div>

<a-scene embedded arjs='sourceType: webcam;'>
    <a-marker preset="hiro">
        <a-plane position="0 0 0" rotation="-90 0 0" width="1" height="1" id="d3-plane"></a-plane>
    </a-marker>
    <a-entity camera></a-entity>
</a-scene>

<script>
    var d3Iframe = document.getElementById('d3-iframe');
    var d3Plane = document.getElementById('d3-plane');

    function updateTexture() {
        html2canvas(d3Iframe.contentDocument.body).then(canvas => {
            var texture = new THREE.CanvasTexture(canvas);
            d3Plane.setAttribute('material', 'src', texture);
            texture.needsUpdate = true;
        });
    }

    function animate() {
        requestAnimationFrame(animate);
        updateTexture();
    }

    d3Iframe.onload = function() {
        // Wait for the iframe content to load before starting the animation loop
        animate();
    }
</script>

</body>
</html>
