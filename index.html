<!DOCTYPE html>
<html>
<head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
        #ar-container {
            position: relative;
            z-index: 0;
        }
        #overlay {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 1;
        }
        #slider {
            position: fixed; /* Stay in place */
            z-index: 1; /* Sit on top */
            left: 0;
            bottom: 0;
            width: 100%;
            background-color: rgba(255,255,255,0.5);
            text-align: center;
        }
    </style>
</head>
<body style="margin: 0; overflow: hidden;">

<div id="ar-container">
    <a-scene embedded arjs='sourceType: webcam;'>
        <a-assets>
            <!-- Define the canvas as a texture -->
            <canvas id="d3-canvas" crossorigin></canvas>
        </a-assets>
        <a-marker preset="hiro">
            <!-- Apply the texture on a plane geometry -->
            <a-plane position="0 0 0" rotation="-90 0 0" width="1" height="1" material="src: #d3-canvas; side: double;"></a-plane>
        </a-marker>
        <a-entity camera></a-entity>
    </a-scene>
</div>

<div id="overlay">
    <iframe id="d3-iframe" style="display: none;" src="visualization.html" width="300" height="300"></iframe>
</div>

<!-- Slider to control D3 visualization -->
<div id="slider">
    <input type="range" min="1" max="100" value="50" class="slider" id="myRange">
</div>

<script>
    var slider = document.getElementById("myRange");
    var iframe = document.getElementById('d3-iframe');
    var d3Canvas = document.getElementById('d3-canvas');
    var d3Context = d3Canvas.getContext('2d');

    // When the iframe is loaded, draw its content onto the canvas.
    iframe.onload = function() {
        function draw() {
            d3Context.clearRect(0, 0, d3Canvas.width, d3Canvas.height);
            d3Context.drawImage(iframe.contentDocument.querySelector('canvas'), 0, 0, 300, 300);
            requestAnimationFrame(draw);
        }
        draw();
    };

    slider.addEventListener("input", function() {
        // Send a message to the iframe with the new value
        iframe.contentWindow.postMessage({
            type: 'updateRadius',
            value: this.value
        }, '*');
    });

    // The script continues to listen for slider changes and communicates with the iframe to update the visualization.

</script>

</body>
</html>
