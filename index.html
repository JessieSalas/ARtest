<!DOCTYPE html>
<html>
<head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
        body { margin: 0; overflow: hidden; }
        #slider-container { position: fixed; bottom: 10px; width: 100%; text-align: center; }
    </style>
</head>
<body>

<a-scene embedded arjs='sourceType: webcam;'>
    <a-assets>
        <img id="d3-image" crossorigin="anonymous">
    </a-assets>
    <a-marker preset="hiro">
        <a-plane position="0 0 0" rotation="-90 0 0" width="1" height="1" material="src: #d3-image;"></a-plane>
    </a-marker>
    <a-entity camera></a-entity>
</a-scene>

<div id="slider-container">
    <input type="range" min="10" max="100" value="50" id="myRange">
</div>

<iframe id="d3-iframe" style="display:none;" src="visualization.html"></iframe>

<script>
    var slider = document.getElementById('myRange');
    var iframe = document.getElementById('d3-iframe');

    slider.addEventListener('input', function() {
        iframe.contentWindow.postMessage({ type: 'updateRadius', value: this.value }, '*');
    });

    window.addEventListener('message', function(event) {
        if (event.data.type === 'render') {
            var img = document.getElementById('d3-image');
            img.src = event.data.dataUrl;  // Receive the data URL from D3 visualization
        }
    });
</script>

</body>
</html>
