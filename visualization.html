<!DOCTYPE html>
<html>
<head>
    <script src="https://d3js.org/d3.v5.min.js"></script>
</head>
<body>

<canvas id="d3-canvas" width="300" height="300"></canvas>

<script>
    var canvas = document.getElementById('d3-canvas');
    var context = canvas.getContext('2d');

    function drawCircle(radius) {
        context.clearRect(0, 0, canvas.width, canvas.height);
        context.beginPath();
        context.arc(150, 150, radius, 0, 2 * Math.PI, false);
        context.fillStyle = 'green';
        context.fill();
        sendImage(); // Send the canvas data to the parent document
    }

    function sendImage() {
        var dataUrl = canvas.toDataURL();
        window.parent.postMessage({ type: 'render', dataUrl: dataUrl }, '*');
    }

    drawCircle(50); // Draw a default circle

    window.addEventListener('message', function(event) {
        if (event.data.type === 'updateRadius') {
            drawCircle(event.data.value);
        }
    });
</script>

</body>
</html>
